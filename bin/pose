#!/usr/bin/env escript
%% -*- erlang -*-

main(Param) ->
    BinDir = filename:absname(filename:dirname(escript:script_name())),
    AppDir = filename:absname_join(BinDir, ".."),
    EbinDir = filename:absname_join(AppDir, "ebin"),
    SrcDir = filename:absname_join(AppDir, "src"),

    Filename = filename:join(SrcDir, "bootstrap.erl"),
    Options = [verbose, warnings_as_errors, return_errors, binary,
               {outdir, EbinDir}],

    case compile:file(Filename, Options) of
        {ok, Module, Binary} ->
            code:load_binary(Module, Filename, Binary),
            bootstrap:main(Param, AppDir);
        _Else                ->
            io:format("** bootstrap: compile failed\n")
    end.

